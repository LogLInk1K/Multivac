---
import '../styles/twikoo.css';
interface Props {
	envId: string;
}

const { envId } = Astro.props;
---
<div id="tcomment"></div>

<script is:inline define:vars={{ envId }}>
	// 等待页面加载完成
	function initTwikoo() {
		twikoo.init({
			envId: envId,
			el: '#tcomment',
			lang: 'zh-CN',
		});
	}

	// 动态加载 Twikoo 脚本
	function loadTwikooScript() {
		const script = document.createElement('script');
		script.src = 'https://registry.npmmirror.com/twikoo/1.6.44/files/dist/twikoo.nocss.js';
		script.onload = initTwikoo;
		document.head.appendChild(script);
	}

	// 页面加载时执行
	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', loadTwikooScript);
	} else {
		loadTwikooScript();
	}
</script>
