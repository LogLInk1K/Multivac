---
import type { HTMLAttributes } from 'astro/types';

type Props = HTMLAttributes<'a'>;

const { href, class: className, ...props } = Astro.props;
const pathname = Astro.url.pathname.replace(import.meta.env.BASE_URL, '');
const subpath = pathname.match(/[^\/]+/g);
const isActive = href === pathname || href === '/' + (subpath?.[0] || '');
---

<a 
	href={href} 
	class:list={[
		"group relative text-text-light dark:text-text-dark transition-all duration-300 font-bold focus:outline-none",
		{ "underline underline-offset-4": isActive },
		className
	]} 
	{...props}
>
	<span class="inline-block transition-all duration-300 group-hover:opacity-0 group-hover:scale-90 group-active:scale-95">
		<slot />
	</span>
	<div class="absolute inset-x-0 top-1/2 -translate-y-1/2 flex items-center justify-center opacity-0 scale-90 transition-all duration-300 group-hover:opacity-100 group-hover:scale-100 group-active:scale-95">
		<div class="bg-primary-light dark:bg-primary-dark rounded-full px-3 py-1 shadow-lg shadow-primary-light/20 dark:shadow-primary-dark/20">
			<span class="text-white dark:text-black font-bold whitespace-nowrap">
				<slot />
			</span>
		</div>
	</div>
</a>

<style>
	/* 移除导航链接的焦点样式 */
	a[href]:focus,
	a[href]:focus-visible {
		outline: none !important;
		box-shadow: none !important;
	}
</style>
